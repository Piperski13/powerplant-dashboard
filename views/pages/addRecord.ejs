<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- account,menu icon bellow -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=account_circle,menu"
    />

    <link rel="icon" href="/assets/icons/favicon.png" type="image/svg+xml" />

    <!-- Local Styles -->
    <link rel="stylesheet" href="/styles/addRecord.css" />
    
    <title><%= record ? "Update Record" : "Add Record" %></title>
  </head>
  <body>
    <div id="main-box">
        <%- include("../partials/navbar.ejs") %>
      <section id="header-section-form">
        <h2>
          <%= record ? "Ažuriraj Evidenciju Elektrane" : "Unos Evidencije Elektrana" %>
        </h2>
        <form
          action="<%= record ? '/records/update/' + record.id : '/records/create/' %>"
          method="POST"
          enctype="multipart/form-data"
          class="form-style"
        >
          <label for="nazivelektrane">Naziv Elektrane</label>
          <input type="text" name="nazivelektrane" placeholder="JKP" value="<%= record ? record.nazivelektrane : '' %>" class="<%= locals.errors.length>0 ? 'input-error' : '' %>" required  />
          <label for="mesto">Mesto</label>
          <input type="text" name="mesto" placeholder="Beograd" value="<%= record ? record.mesto : '' %>" class="<%= locals.errors.length>0 ? 'input-error' : '' %>" required />
          <label for="adresa">Adresa</label>
          <input type="text" name="adresa" placeholder="Beograd" value="<%= record ? record.adresa : '' %>" class="<%= locals.errors.length>0 ? 'input-error' : '' %>" required />
          <label class="sifravrstepogona-js" for="sifravrstepogona"
            >Šifra vrste pogona</label
          >
          <select name="sifravrstepogona" id="sifravrstepogona" required>
            <option value="0" <%= record && record.sifravrstepogona == 0 ? 'selected' : '' %>>Voda</option>
            <option value="1" <%= record && record.sifravrstepogona == 1 ? 'selected' : '' %>>Vetar</option>
            <option value="2" <%= record && record.sifravrstepogona == 2 ? 'selected' : '' %>>Ugalj</option>
          </select>

          <label for="datumpustanjaurad">Datum puštanja u rad</label>
          <input
            type="date"
            id="datumpustanjaurad_input"
            name="datumpustanjaurad"
            placeholder="Select Date"
            value="<%= record ? record.datumpustanjaurad.toISOString().split('T')[0] : '' %>"
            required
          />
          <label for="file">Dokumenti</label>

          <% if (files && files.length > 0) { %>
            <ul class="files-ul">
              <% files.forEach(file => { %>
                <li>
                  <a href="<%= process.env.UPLOADS_URL %>/<%= file.filename %>" target="_blank">
                    <%= file.original_name %>
                  </a>
                  <button 
                    type="button" 
                    class="delete-file-btn" 
                    data-file-id="<%= file.id %>"
                  >
                    X
                  </button>
                </li>
              <% }) %>
            </ul>
          <% } %>

          <div id="drop-zone">
            Drag & Drop files here<br />
            or click to select
          </div>
          <input type="file" id="file-input" name="myFile" multiple hidden />
          <div class="submit-row">
            <%- include("../partials/errors.ejs") %>
            <button type="submit" class="form-submit-button"><%= record ? "Update Record" : "Add Record" %></button>
          </div>
        </form>
      </section>
    </div>

    <script src="/scripts/hamburger_menu/toggleMenu.js"></script>
    <script src="/scripts/todaysDate.js"></script>
    <script src="/scripts/drag.js"></script>
    <script src="/scripts/recordFiles/deleteFile.js"></script>
  </body>
</html>
